<div id="dc-overlay" class="dc-overlay">
    <div id="dc-overlay-upload" class="dc-overlay-centerfield" style="display:none; top: 5%;">
        <div class="dc-ruler-align">
            <input type="text" class="dc-input-field" id="dc-file-path"
                   style="width: 100%;padding: 2px;margin-left: 4px;" readonly title="File Path"/>
            <button class="dc-button dc-button-inverse" type="button" id="dc-select-file-path-btn"
                    style="top: -8px;"> . . .</button>
        </div>

        <textarea class="dc-textarea" rows="20" cols="128" id="dc-file-message-textarea"
                  placeholder="Enter any addition text to send with your message ..." maxlength="1820"></textarea>

        <div class="dc-ruler-align" style="font-size:14px; padding-bottom:10px;">
            <input id="dc-file-deletion-checkbox" class="ui-switch-checkbox" type="checkbox"
                   title="Add Deletion Link">
            <span style="margin-top: 5px;">Send Deletion Link</span>
        </div>
        <div class="dc-ruler-align" style="font-size:14px; padding-bottom:10px;">
            <input id="dc-file-name-random-checkbox" class="ui-switch-checkbox" type="checkbox" checked
                   title="Use Random File Name">
            <span style="margin-top: 5px;">Randomize File Name</span>
        </div>

        <div class="stat stat-bar">
            <span id = "dc-file-upload-status" class="stat-bar-rating" style="width: 0;"/>
        </div>

        <div class="dc-ruler-align">
            <button class="dc-button" style="width:100%;" id="dc-file-upload-btn">Upload</button>
        </div>

        <div class="dc-ruler-align">
            <button class="dc-button dc-button-inverse" style="width:100%;" id="dc-file-cancel-btn">
                Close</button>
        </div>
    </div>
    <div id="dc-overlay-password" class="dc-overlay-centerfield" style="display:none;">
        <span>Primary Password:</span>
        <input type="password" class="dc-password-field" id="dc-password-primary" placeholder="..."/><br/>

        <span>Secondary Password:</span>
        <input type="password" class="dc-password-field" id="dc-password-secondary" placeholder="..."/><br/>

        <div class="dc-ruler-align">
            <button class="dc-button" id="dc-save-pwd">Update Passwords</button>
            <button class="dc-button dc-button-inverse" id="dc-reset-pwd">Reset Passwords</button>
            <button class="dc-button dc-button-inverse" id="dc-cancel-btn">Cancel</button>
        </div>

        <button class="dc-button dc-button-inverse" style="width: 100%;" id="dc-cpy-pwds-btn">
            Copy Current Passwords</button>
    </div>
    <div id="dc-update-overlay" class="dc-overlay-centerfield"
         style="top: 5%;border: 1px solid;display: none">
        <span>DiscordCrypt: Update Available</span>
        <div class="dc-ruler-align">
            <strong class="dc-hint dc-update-field" id="dc-new-version"/>
        </div>
        <div class="dc-ruler-align">
            <strong class="dc-hint dc-update-field" id="dc-old-version"/>
        </div>
        <div class="dc-ruler-align">
            <strong class="dc-hint dc-update-field">Changelog:</strong></div>
        <div class="dc-ruler-align">
            <textarea class="dc-textarea" rows="20" cols="128" id="dc-changelog" readonly title="Update Changes"/>
        </div>
        <br>
        <div class="dc-ruler-align">
            <button class="dc-button" id="dc-restart-now-btn" style="width: 50%;">
                Restart Discord Now</button>
            <button class="dc-button dc-button-inverse" id="dc-restart-later-btn" style="width: 50%;">
                Restart Discord Later</button>
        </div>
    </div>
    <div id="dc-overlay-settings" class="dc-overlay-main" style="display: none;">
        <div class="tab" id="dc-settings-tab">
            <button class='dc-tab-link' id="dc-exit-settings-btn" style="float:right;">[ X ]</button>
        </div>
        <div class="tab-content" id="dc-settings" style="display: block;">
            <p style="text-align: center;">
                <b>DiscordCrypt Settings</b>
            </p>
            <br/><br/>

            <div class="dc-ruler-align">
                <div class="dc-input-label">Primary Cipher:</div>
                <select class="dc-input-field" id="dc-primary-cipher" title="Primary Cipher">
                    <option value="bf" selected>Blowfish ( 512-Bit )</option>
                    <option value="aes">AES ( 256-Bit )</option>
                    <option value="camel">Camellia ( 256-Bit )</option>
                    <option value="tdes">TripleDES ( 192-Bit )</option>
                    <option value="idea">IDEA ( 128-Bit )</option>
                </select>
            </div>

            <div class="dc-ruler-align">
                <div class="dc-input-label">Secondary Cipher:</div>
                <select class="dc-input-field" id="dc-secondary-cipher" title="Secondary Cipher">
                    <option value="bf">Blowfish ( 512-Bit )</option>
                    <option value="aes">AES ( 256-Bit )</option>
                    <option value="camel">Camellia ( 256-Bit )</option>
                    <option value="idea">IDEA ( 256-Bit )</option>
                    <option value="tdes">TripleDES ( 192-Bit )</option>
                </select>
            </div>

            <div class="dc-ruler-align">
                <div class="dc-input-label">Cipher Padding Mode:</div>
                <select class="dc-input-field" id="dc-settings-padding-mode" title="Cipher Padding Scheme">
                    <option value="pkc7">PKCS #7</option>
                    <option value="ans2">ANSI X9.23</option>
                    <option value="iso1">ISO 10126</option>
                    <option value="iso9">ISO 97971</option>
                </select>
            </div>

            <div class="dc-ruler-align">
                <div class="dc-input-label">Cipher Block Operation Mode:</div>
                <select class="dc-input-field" id="dc-settings-cipher-mode" title="Cipher Block Operation Mode">
                    <option value="cbc">Cipher Block Chaining</option>
                    <option value="cfb">Cipher Feedback Mode</option>
                    <option value="ofb">Output Feedback Mode</option>
                </select>
            </div>

            <div class="dc-ruler-align">
                <div class="dc-input-label">Default Encryption Password:</div>
                <input type="text" class="dc-input-field" id="dc-settings-default-pwd"
                       title="Default Encryption Password"/>
            </div>

            <div class="dc-ruler-align">
                <div class="dc-input-label">Scanning Frequency:</div>
                <input type="text" class="dc-input-field" id="dc-settings-scan-delay"
                       title="Scanning Frequency"/>
            </div>

            <div class="dc-ruler-align">
                <div class="dc-input-label">Message Trigger:</div>
                <input type="text" class="dc-input-field" id="dc-settings-encrypt-trigger" title="Message Trigger"/>
            </div>

            <div class="dc-hint">
                <p>The suffix at the end of a typed message to indicate whether to encrypt the text.</p>
                <p>Example: <u>This message will be encrypted.|ENC</u></p>
            </div>

            <div class="dc-ruler-align">
                <div class="dc-input-label">Timed Message Expiration:</div>
                <input type="number" class="dc-input-field" id="dc-settings-timed-expire"
                       title="Timed Message Expiration"/>
            </div>

            <div class="dc-hint">
                <p>This indicates how long after an encrypted message is sent, should it be deleted in minutes.</p>
                <p><u>Set this to "0" to disable timed messages.</u></p>
            </div>

            <div class="dc-ruler-align">
                <div class="dc-input-label">New Master Database Password:</div>
                <input type="text" class="dc-input-field" id="dc-master-password"
                       title="New Master Database Password"/>
            </div>

            <div class="dc-ruler-align">
                <div class="dc-input-label">Use Embedded Messages:</div>
                <input type="checkbox" class="dc-input-field" id="dc-embed-enabled"
                       title="Use Embedded Messages"/>
            </div>

            <div class="dc-hint">
                <p>If enabled, send all encrypted messages using embeds.</p>
                <p>
                    <b style="color: #f00">WARNING:</b>
                    <b> Using this option may result in your embedded permissions being globally revoked.</b>
                </p>
            </div>

            <div class="dc-ruler-align">
                <button id="dc-settings-save-btn" class="dc-button">Save & Apply</button>
                <button id="dc-settings-reset-btn" class="dc-button dc-button-inverse">
                    Reset Settings</button>
            </div>
        </div>
    </div>
    <div id="dc-overlay-exchange" class="dc-overlay-main" style="display: none;">
        <div class="tab" id="dc-exchange-tab">
            <button class='dc-tab-link' id="dc-tab-info-btn">Info</button>
            <button class='dc-tab-link' id="dc-tab-keygen-btn">Key Generation</button>
            <button class='dc-tab-link' id="dc-tab-handshake-btn">Secret Computation</button>
            <button class='dc-tab-link' id="dc-exit-exchange-btn" style="float:right;">[ X ]</button>
        </div>
        <div class="tab-content" id="dc-about-tab" style="display: block;">
            <p style="text-align: center;">
                <b>Key Exchanger</b>
            </p>
            <br/>

            <strong>What is this used for?</strong>
            <ul class="dc-list">
                <li>Simplifying the process or generating strong passwords for each user of DiscordCrypt
                    requires a secure channel to exchange these keys.</li>
                <li>Using this generator, you may create new keys using standard algorithms such as
                    DH or ECDH for manual handshaking.</li>
                <li>Follow the steps below and you can generate a password between channels or users
                    while being able to publicly post the messages.</li>
                <li>This generator uses secure hash algorithms ( SHA-256 and SHA-512 ) in tandem with
                    the Scrypt KDF function to derive two keys.</li>
            </ul>
            <br/>

            <strong>How do I use this?</strong>
            <ul class="dc-list">
                <li>Generate a key pair using the specified algorithm and key size on the
                    "Key Generation" tab.</li>
                <li>Give your partner your public key by clicking the "Send Public Key" button.</li>
                <li>Ask your partner to give you their public key using the same step above.</li>
                <li>Copy your partner's public key and paste it in the "Secret Computation" tab and
                    select "Compute Secret Keys".</li>
                <li>Wait for <span style="text-decoration: underline;color: #ff0000;">BOTH</span>
                    the primary and secondary keys to be generated.</li>
                <li>A status bar is provided to easily tell you when both passwords
                    have been generated.</li>
                <li>Click the "Apply Generated Passwords" button to apply both passwords to
                    the current user or channel.</li>
            </ul>

            <strong>Algorithms Supported:</strong>
            <ul class="dc-list">
                <li>
                    <a title="Diffie–Hellman key exchange"
                       href="https://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange"
                       target="_blank" rel="noopener">Diffie-Hellman ( DH )</a>
                </li>
                <li>
                    <a title="Elliptic curve Diffie–Hellman"
                       href="https://en.wikipedia.org/wiki/Elliptic_curve_Diffie%E2%80%93Hellman"
                       target="_blank" rel="noopener">Elliptic Curve Diffie-Hellman ( ECDH )</a>
                </li>
            </ul>

            <span style="text-decoration: underline; color: #ff0000;">
                            <strong>DO NOT:</strong>
                        </span>
            <ul class="dc-list dc-list-red">
                <li>
                    <strong>Post your private key. If you do, generate a new one IMMEDIATELY.</strong>
                </li>
                <li>
                    <strong>Alter your public key or have your partner alter theirs in any way.</strong>
                </li>
                <li>
                    <strong>Insert a random public key.</strong>
                </li>
            </ul>
        </div>
        <div class="tab-content" id="dc-keygen-tab" style="display: block;">
            <p style="text-align: center;">
                <b style="font-size: large;">Secure Key Generation</b>
            </p>
            <br/>

            <strong>Exchange Algorithm:</strong>
            <select id="dc-keygen-method" title="Exchange Algorithm">
                <option value="dh" selected>Diffie-Hellman</option>
                <option value="ecdh">Elliptic-Curve Diffie-Hellman</option>
            </select>
            <br/><br/>

            <strong>Key Length ( Bits ):</strong>
            <select id="dc-keygen-algorithm" title="Key Length">
                <option value="768">768</option>
                <option value="1024">1024</option>
                <option value="1536">1536</option>
                <option value="2048">2048</option>
                <option value="3072">3072</option>
                <option value="4096">4096</option>
                <option value="6144">6144</option>
                <option value="8192" selected>8192</option>
            </select>
            <br/><br/>

            <div class="dc-ruler-align">
                <button id="dc-keygen-gen-btn" class="dc-button">Generate</button>
                <button id="dc-keygen-clear-btn" class="dc-button dc-button-inverse">Clear</button>
            </div>
            <br/><br/><br/>

            <strong>Private Key: (
                <span style="text-decoration: underline; color: #ff0000;">KEEP SECRET</span>
                )</strong><br/>
            <textarea id="dc-priv-key-ta" rows="8" cols="128" maxsize="8192"
                      unselectable="on" disabled readonly title="Private Key"/>
            <br/><br/>

            <strong>Public Key:</strong><br/>
            <textarea id="dc-pub-key-ta" rows="8" cols="128" maxsize="8192"
                      unselectable="on" disabled readonly title="Public Key"/>
            <br/><br/>

            <div class="dc-ruler-align">
                <button id="dc-keygen-send-pub-btn" class="dc-button">Send Public Key</button>
            </div>
            <br/>

            <ul class="dc-list dc-list-red">
                <li>Never rely on copying these keys. Use the "Send Public Key" button
                    to send your key.</li>
                <li>Public keys are automatically encoded with a random salts.</li>
                <li>Posting these keys directly won't work since they aren't encoded
                    in the format required.</li>
            </ul>
        </div>
        <div class="tab-content" id="dc-handshake-tab">
            <p style="text-align: center;">
                <b style="font-size: large;">Key Derivation</b>
            </p>
            <br/>

            <p>
                            <span style="text-decoration: underline; color: #ff0000;">
                                <strong>NOTE:</strong>
                            </span>
            </p>
            <ul class="dc-list dc-list-red">
                <li>Copy your partner's private key EXACTLY as it was posted.</li>
                <li>Your last generated private key from the "Key Generation" tab
                    will be used to compute these keys.</li>
            </ul>
            <br/>

            <strong>Partner's Public Key:</strong><br/>
            <textarea id="dc-handshake-ppk" rows="8" cols="128" maxsize="16384" title="Partner's Public Key"/>
            <br/><br/>

            <div class="dc-ruler-align">
                <button id="dc-handshake-paste-btn" class="dc-button dc-button-inverse">
                    Paste From Clipboard</button>
                <button id="dc-handshake-compute-btn" class="dc-button">Compute Secret Keys</button>
            </div>

            <ul class="dc-list dc-list-red">
                <li id="dc-handshake-algorithm">...</li>
                <li id="dc-handshake-salts">...</li>
                <li id="dc-handshake-secret">...</li>
            </ul>
            <br/>

            <strong id="dc-handshake-prim-lbl">Primary Secret:</strong><br/>
            <textarea id="dc-handshake-primary-key" rows="1" columns="128" maxsize="32768"
                      style="max-height: 14px;user-select: none;" unselectable="on" disabled
                      title="Primary Secret"/>
            <br/><br/>

            <strong id="dc-handshake-sec-lbl">Secondary Secret:</strong><br/>
            <textarea id="dc-handshake-secondary-key" rows="1" columns="128" maxsize="32768"
                      style="max-height: 14px;user-select: none;" unselectable="on" disabled
                      title="Secondary Secret"/>
            <br/><br/>

            <div class="stat stat-bar" style="width:70%;">
                <span id="dc-exchange-status" class="stat-bar-rating" style="width: 0;"/>
            </div><br/>

            <div class="dc-ruler-align">
                <button id="dc-handshake-cpy-keys-btn" class="dc-button dc-button-inverse">
                    Copy Keys & Nuke</button>
                <button id="dc-handshake-apply-keys-btn" class="dc-button">
                    Apply Generated Passwords</button>
            </div>
        </div>
    </div>
</div>
